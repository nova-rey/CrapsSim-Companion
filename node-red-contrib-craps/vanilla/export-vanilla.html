<script type="text/javascript">
RED.nodes.registerType('export', {
  category: 'Craps: Execution',
  color: '#6A4CCF',
  defaults: {
    name: { value: "" },
    filename: { value: "strategy.py" }
  },
  inputs: 1,
  outputs: 1,
  icon: "icons/execution-node.svg",
  paletteLabel: "Run: Export to CrapsSim (Legacy)",
  label: function() { return this.name || "Run: Export (Legacy)"; }
});
</script>

<script type="text/x-red" data-template-name="export" data-label="Run: Export to CrapsSim (Legacy)">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" placeholder="">
  </div>
  <div class="form-row">
    <label for="node-input-filename"><i class="fa fa-file"></i> Filename</label>
    <input type="text" id="node-input-filename" placeholder="strategy_vanilla.py">
  </div>
  <div class="form-tips">
    Emits a CrapsSim-compatible Python strategy with all non-bubble bets auto-legalized.
  </div>
</script>

<script type="text/x-red" data-help-name="export">
  <h3>What this node does</h3>
  <p>Generates a legacy CrapsSim-compatible Python strategy file from the compiled bet recipe. This is the legacy export path; Engine API users should prefer the runtime runner nodes.</p>

  <h3>Inputs</h3>
  <ul>
    <li><b>Filename</b>: Target filename for the exported strategy.</li>
    <li><b>Message fields</b>: expects <code>msg.strategy_config</code> from <b>Compile Strategy</b>; falls back to <code>msg.recipe.steps</code> plus optional <code>msg.varTable</code> to convert units to dollars and legalize bets.</li>
  </ul>

  <h3>Outputs</h3>
  <p>Emits the generated Python code on <code>msg.payload</code> and forwards the filename on <code>msg.filename</code>.</p>

  <h3>Errors</h3>
  <ul>
    <li>Missing or invalid bet recipe.</li>
    <li>Unsupported bet types for the legacy exporter.</li>
  </ul>
</script>
